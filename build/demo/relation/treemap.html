<html>
  <head>
    <script src="//g.alicdn.com/bizcharts/io-asserts/3.1.2/react16.0.0.production.min.js"></script>
    <script src="//g.alicdn.com/bizcharts/io-asserts/3.1.2/react-dom16.0.0.production.min.js"></script>
	  <script type="text/javascript" src="//gw.alipayobjects.com/os/antv/assets/data-set/0.8.6/data-set.min.js"></script>
    <script src="//cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
    <script src="//g.alicdn.com/bizcharts/io-asserts/3.1.5/BizCharts.min.js"> </script>
    <script type="text/javascript" src="https://gw.alipayobjects.com/as/g/datavis/assets/1.0.1/jquery-3.2.1.min.js"></script>

  </head>
  <body>

   <div id="c1" ></div>
   <script type="text/babel">

      const { Chart, Axis, Geom, Tooltip, Facet, View, Legend, Label, Coord } = window.BizCharts;
      const { DataView } = DataSet;
      const data = {
        name: 'root',
        children: [
          { name: '分类 1', value: 560 },
          { name: '分类 2', value: 500 },
          { name: '分类 3', value: 150 },
          { name: '分类 4', value: 140 },
          { name: '分类 5', value: 115 },
          { name: '分类 6', value: 95 },
          { name: '分类 7', value: 90 },
          { name: '分类 8', value: 75 },
          { name: '分类 9', value: 98 },
          { name: '分类 10', value: 60 },
          { name: '分类 11', value: 45 },
          { name: '分类 12', value: 40 },
          { name: '分类 13', value: 40 },
          { name: '分类 14', value: 35 },
          { name: '分类 15', value: 40 },
          { name: '分类 16', value: 40 },
          { name: '分类 17', value: 40 },
          { name: '分类 18', value: 30 },
          { name: '分类 19', value: 28 },
          { name: '分类 20', value: 16 }
        ]
      };
      const dv = new DataView();
      dv.source(data, {
        type: 'hierarchy',
      }).transform({
        field: 'value',
        type: 'hierarchy.treemap',
        tile: 'treemapResquarify',
        as: ['x', 'y'],
      });
      const nodes = dv.getAllNodes();
      nodes.map(node => {
        node.name = node.data.name;
        node.value = node.data.value;
        return node;
      });

      const scale = {
        value:{nice:false}
      }

      const htmlStr = '<li data-index={index}>'
          + '<span style="background-color:{color};" class="g2-tooltip-marker"></span>'
          + '{name}<br/>'
          + '<span style="padding-left: 16px">浏览人数：{count}</span><br/>'
          + '</li>';

      ReactDOM.render(
        <Chart  data={nodes} forceFit={true} height={window.innerHeight} scale={scale} >
          <Tooltip showTitle={false} itemTpl={htmlStr}/>
          <Geom type='polygon' position='x*y' color='name' tooltip={['name*value', (name, count)=>{
            return {
              name,
              count,
            }
          }]} style={{lineWidth:1, stroke:"#fff"}}>
            <Label content='name' offset={0} textStyle={{textBaseline:'middle'}} formatter={(val)=>{
              if(val !== 'root') {
                return val;
              }
            }}/>
          </Geom>
        </Chart>, document.getElementById('c1')
      );
    </script>
  </body>
</html>